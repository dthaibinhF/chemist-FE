# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a React + TypeScript + Vite frontend application for a school management system called "Chemist FE". It's a comprehensive education management platform that handles students, fees, groups, schedules, and includes an AI assistant feature.

## Key Technologies & Architecture

- **Frontend**: React 19 + TypeScript + Vite
- **UI Framework**: Radix UI primitives with shadcn/ui components
- **Styling**: TailwindCSS v4 
- **State Management**: Redux Toolkit with feature-based slices
- **Routing**: React Router DOM v7
- **Forms**: React Hook Form with Zod validation
- **AI Integration**: Google Gemini AI with custom tool engine
- **Database Integration**: PostgreSQL via MCP server for AI assistant

## Development Commands

```bash
# Development server (runs on port 3005)
npm run dev

# Build for production
npm run build

# Linting
npm run lint
npm run lint:fix

# Code formatting
npm run format

# Preview production build
npm run preview

# AI Assistant MCP server
npm run mcp-server

# Setup MCP server
npm run setup-mcp
```

## Project Structure

### Core Directories

- `src/pages/` - Route components (Dashboard, Student Management, Finance, Groups, etc.)
- `src/feature/` - Feature modules with their own components, services, hooks, and Redux slices
- `src/components/` - Reusable UI components split into `common/`, `features/`, and `ui/`
- `src/service/` - API service layer for backend communication
- `src/redux/` - Redux store configuration and feature slices
- `src/hooks/` - Custom React hooks
- `src/types/` - TypeScript type definitions

### Feature Structure

Each feature follows a consistent structure:
```
src/feature/{feature-name}/
├── components/     # Feature-specific components
├── services/       # API services for this feature
├── hooks/         # Custom hooks for this feature
├── slice/         # Redux slice for state management
├── types/         # TypeScript types
└── schemas/       # Zod validation schemas
```

## API Services Architecture

All API services are located in `src/service/` and follow CRUD patterns:
- Each service provides methods like `getAll()`, `getById()`, `create()`, `update()`, `delete()`
- Services use the centralized `api-client.ts` which handles authentication automatically
- Token management and refresh is handled transparently
- All services throw errors on API failures - always use try-catch blocks

## State Management

- Uses Redux Toolkit with feature-based slices
- Each major feature has its own slice in `src/redux/slice/` or within the feature directory
- Store configuration is in `src/redux/store.ts`
- Use typed hooks from `src/redux/hook.ts`

## UI Components

- Uses shadcn/ui components in `src/components/ui/`
- Common reusable components in `src/components/common/`
- Feature-specific components in `src/components/features/`
- All components use TypeScript and follow consistent naming conventions

## AI Assistant Feature

- Integrated Google Gemini AI with custom tool engine
- Located in `src/feature/ai-assistant/`
- Connects to PostgreSQL database via MCP (Model Context Protocol) server
- Tools engine provides database access and API integration capabilities
- Custom UI components for chat interface in `src/components/ui/kibo-ui/`

## Authentication

- JWT-based authentication with automatic token refresh
- Auth logic in `src/feature/auth/`
- Token management handles expired tokens transparently
- All API calls automatically include authentication headers

## Environment Setup

Required environment variables:
- `VITE_GEMINI_API_KEY` - For AI assistant functionality

## File Upload & Media

- File upload components in `src/components/file-view-and-picker/`
- Handles local storage, media files, and public API integration
- Used for student data import (CSV files) and document management

## Timetable/Schedule System

- Complex scheduling system in `src/components/features/schedule/`
- Supports daily and weekly views
- Event management with modals and filters
- Integration with group and room management

## Development Notes

- Uses absolute imports with `@/` alias pointing to `src/`
- All API services include comprehensive Vietnamese documentation
- Error boundaries implemented for robust error handling
- Responsive design with mobile-first approach using TailwindCSS
- Form validation uses Zod schemas consistently across features

## Database Integration

The AI assistant connects to a PostgreSQL database via MCP server:
- Database: `chemist` on `localhost:5432`
- Credentials: `postgres:root`
- MCP server runs on port 3000
- Provides read access to database, write access only when explicitly requested